/* eslint-disable react/prop-types */
import React from "react";
import styles from "./ArButton.module.scss";
import QRCode from "react-qr-code";
import { MobileAr } from "../arViews/MobileAr";
import { isMobile } from "react-device-detect";
import { TwoSeventyRing } from "react-svg-spinners";

function ArButton({ mesh }) {
  const [isOpen, setIsOpen] = React.useState(false);
  const [arAvailable, setArAvailble] = React.useState(false);
  const [isLoading, setLoading] = React.useState(true);

  return (
    <>
      <div
        className={styles.arButton}
        onClick={() => {
          if (!isMobile) {
            setIsOpen(true);
          }
        }}
      >
        {isMobile ? (
          <>
            {mesh ? (
              <MobileAr
                mesh={mesh}
                setArAvailble={setArAvailble}
                setLoading={setLoading}
                isLoading={isLoading}
              />
            ) : (
              ""
            )}
            {isLoading ? <TwoSeventyRing color="#fff" /> : <></>}
          </>
        ) : (
          <>
            <svg
              width="14"
              height="14"
              viewBox="0 0 14 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M6.33331 11.9833L2.99998 10.0667C2.78887 9.94444 2.62509 9.78333 2.50865 9.58333C2.3922 9.38333 2.33376 9.16111 2.33331 8.91666V5.08333C2.33331 4.83888 2.39176 4.61666 2.50865 4.41666C2.62554 4.21666 2.78931 4.05555 2.99998 3.93333L6.33331 2.01666C6.54442 1.89444 6.76665 1.83333 6.99998 1.83333C7.23331 1.83333 7.45554 1.89444 7.66665 2.01666L11 3.93333C11.2111 4.05555 11.3751 4.21666 11.492 4.41666C11.6089 4.61666 11.6671 4.83888 11.6666 5.08333V8.91666C11.6666 9.16111 11.6084 9.38333 11.492 9.58333C11.3755 9.78333 11.2115 9.94444 11 10.0667L7.66665 11.9833C7.45554 12.1056 7.23331 12.1667 6.99998 12.1667C6.76665 12.1667 6.54442 12.1056 6.33331 11.9833ZM6.33331 10.45V7.38333L3.66665 5.83333V8.91666L6.33331 10.45ZM7.66665 10.45L10.3333 8.91666V5.83333L7.66665 7.38333V10.45ZM0.99998 4.33333C0.811091 4.33333 0.652869 4.26933 0.525313 4.14133C0.397758 4.01333 0.333757 3.85511 0.333313 3.66666V1.66666C0.333313 1.29999 0.46398 0.986217 0.725313 0.725328C0.986646 0.464439 1.30042 0.333773 1.66665 0.333328H3.66665C3.85554 0.333328 4.01398 0.397328 4.14198 0.525328C4.26998 0.653328 4.33376 0.81155 4.33331 0.999995C4.33287 1.18844 4.26887 1.34688 4.14131 1.47533C4.01376 1.60377 3.85554 1.66755 3.66665 1.66666H1.66665V3.66666C1.66665 3.85555 1.60265 4.01399 1.47465 4.14199C1.34665 4.26999 1.18842 4.33377 0.99998 4.33333ZM1.66665 13.6667C1.29998 13.6667 0.986202 13.5362 0.725313 13.2753C0.464424 13.0144 0.333757 12.7004 0.333313 12.3333V10.3333C0.333313 10.1444 0.397313 9.98622 0.525313 9.85866C0.653313 9.73111 0.811535 9.66711 0.99998 9.66666C1.18842 9.66622 1.34687 9.73022 1.47531 9.85866C1.60376 9.98711 1.66754 10.1453 1.66665 10.3333V12.3333H3.66665C3.85554 12.3333 4.01398 12.3973 4.14198 12.5253C4.26998 12.6533 4.33376 12.8116 4.33331 13C4.33287 13.1884 4.26887 13.3469 4.14131 13.4753C4.01376 13.6038 3.85554 13.6676 3.66665 13.6667H1.66665ZM12.3333 13.6667H10.3333C10.1444 13.6667 9.9862 13.6027 9.85865 13.4747C9.73109 13.3467 9.66709 13.1884 9.66665 13C9.6662 12.8116 9.7302 12.6533 9.85865 12.5253C9.98709 12.3973 10.1453 12.3333 10.3333 12.3333H12.3333V10.3333C12.3333 10.1444 12.3973 9.98622 12.5253 9.85866C12.6533 9.73111 12.8115 9.66711 13 9.66666C13.1884 9.66622 13.3469 9.73022 13.4753 9.85866C13.6038 9.98711 13.6675 10.1453 13.6666 10.3333V12.3333C13.6666 12.7 13.5362 13.014 13.2753 13.2753C13.0144 13.5367 12.7004 13.6671 12.3333 13.6667ZM12.3333 3.66666V1.66666H10.3333C10.1444 1.66666 9.9862 1.60266 9.85865 1.47466C9.73109 1.34666 9.66709 1.18844 9.66665 0.999995C9.6662 0.81155 9.7302 0.653328 9.85865 0.525328C9.98709 0.397328 10.1453 0.333328 10.3333 0.333328H12.3333C12.7 0.333328 13.014 0.463995 13.2753 0.725328C13.5366 0.986662 13.6671 1.30044 13.6666 1.66666V3.66666C13.6666 3.85555 13.6026 4.01399 13.4746 4.14199C13.3466 4.26999 13.1884 4.33377 13 4.33333C12.8115 4.33288 12.6533 4.26888 12.5253 4.14133C12.3973 4.01377 12.3333 3.85555 12.3333 3.66666ZM6.99998 6.23333L9.63331 4.68333L6.99998 3.16666L4.36665 4.68333L6.99998 6.23333Z"
                fill="white"
              />
            </svg>
            <p>See In Real Life</p>
          </>
        )}
      </div>
      {isOpen && (
        <div className={styles.modal}>
          <div className={styles.close} onClick={() => setIsOpen(false)}>
            <svg
              width="15"
              height="15"
              viewBox="0 0 15 15"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M8.24954 7.497L13.8775 1.8635C13.9768 1.76372 14.0325 1.62866 14.0324 1.4879C14.0323 1.34713 13.9765 1.21215 13.877 1.1125C13.678 0.9145 13.3275 0.9135 13.1265 1.1135L7.50004 6.747L1.87154 1.112C1.67154 0.9145 1.32104 0.9155 1.12204 1.113C1.07265 1.1622 1.03355 1.22074 1.00702 1.28521C0.980493 1.34968 0.967073 1.41879 0.967541 1.4885C0.967541 1.6305 1.02254 1.7635 1.12204 1.862L6.75004 7.4965L1.12254 13.1315C1.02323 13.2314 0.967621 13.3667 0.967902 13.5076C0.968183 13.6484 1.02434 13.7835 1.12404 13.883C1.22054 13.9785 1.35704 14.0335 1.49804 14.0335H1.50104C1.64254 14.033 1.77904 13.9775 1.87354 13.881L7.50004 8.2475L13.1285 13.8825C13.228 13.9815 13.361 14.0365 13.502 14.0365C13.5718 14.0367 13.6408 14.0231 13.7053 13.9965C13.7697 13.9699 13.8283 13.9309 13.8776 13.8816C13.9269 13.8323 13.966 13.7737 13.9926 13.7092C14.0192 13.6448 14.0327 13.5757 14.0325 13.506C14.0325 13.3645 13.9775 13.231 13.8775 13.1325L8.24954 7.497Z"
                fill="#4169E1"
              />
            </svg>
          </div>
          <div className={styles.info}>
            Scan the QR code with your phone. Within 1-3 seconds the AR function
            opens on your phone.
          </div>
          <div className={styles.qrCode}>
            <QRCode
              size={120}
              style={{ height: "auto", maxWidth: "100%", width: "100%" }}
              value={window.location.href}
              viewBox={`0 0 256 256`}
              fgColor="#4169e1"
            />
          </div>
        </div>
      )}
    </>
  );
}

export default ArButton;
